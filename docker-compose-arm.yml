version: '3.7'
services:
  mssql1:
    restart: on-failure
    networks:
      - localnet
    container_name: mssql1
    hostname: mssql1
    image: dbatools/sqlinstance:latest-arm64
    build:
      context: .
      dockerfile: dockerfile
      args:
        PRIMARYSQL: "TRUE"
        IMAGE: "mcr.microsoft.com/azure-sql-edge"
        FINALIMAGE: "dbatools/sqlinstance:latest-arm64"
        BUILD_DATE: $(date -u +'%Y-%m-%dT%H:%M:%SZ')
    ports:
      - "1433:1433"
    env_file:
      - sql/sapassword.env
    volumes:
      - shared:/shared:z
  mssql2:
    restart: on-failure
    networks:
      - localnet
    container_name: mssql2
    hostname: mssql2
    image: dbatools/sqlinstance2:latest-arm64
    build:
      context: .
      dockerfile: dockerfile
      args:
        IMAGE: "mcr.microsoft.com/azure-sql-edge"
        FINALIMAGE: "dbatools/sqlinstance2:latest-arm64"
        BUILD_DATE: $(date -u +'%Y-%m-%dT%H:%M:%SZ')
    ports:
      - "14333:1433"
    env_file:
      - sql/sapassword.env
    volumes:
      - shared:/shared:z

networks:
  localnet: null
volumes:
  shared: null
